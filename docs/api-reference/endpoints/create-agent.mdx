---
title: "Create Agent"
api: "POST https://api.magpipe.ai/functions/v1/create-agent"
description: "Create a new AI agent with custom configuration"
---

## Overview

Creates a new AI agent that can handle phone calls, SMS messages, and chat conversations. Agents are fully customizable with their own personality, voice, and capabilities.

## Request

### Headers

<ParamField header="Authorization" type="string" required>
  Bearer token â€” either a Supabase JWT or a `mgp_` API key.
</ParamField>

<ParamField header="Content-Type" type="string" required>
  Must be `application/json`
</ParamField>

### Body Parameters

<ParamField body="name" type="string" required>
  Display name for the agent.

  **Example:** `"Reception Agent"`

  **Constraints:**
  - 1-100 characters
</ParamField>

<ParamField body="greeting" type="string">
  The message the agent says when answering a call.

  **Example:** `"Hello, thanks for calling Acme Corp. How can I help you today?"`

  **Constraints:**
  - Maximum 500 characters
  - Should be under 15 seconds when spoken
</ParamField>

<ParamField body="system_prompt" type="string">
  Instructions that define the agent's personality, knowledge, and behavior. This is the most important setting for customizing agent responses.

  **Example:**
  ```
  You are Sarah, a friendly receptionist for Acme Corp.

  Your responsibilities:
  - Answer questions about our services
  - Help callers schedule appointments
  - Take messages when needed

  Business hours: Monday-Friday, 9am-5pm
  Location: 123 Main St, Vancouver BC

  Always be professional and helpful.
  ```

  **Constraints:**
  - Maximum 10,000 characters
  - Supports markdown formatting
</ParamField>

<ParamField body="voice_id" type="string">
  ID of the voice to use for phone calls. Use the [List Voices](/api-reference/endpoints/list-voices) endpoint to get all available options.

  **Popular ElevenLabs voices:**
  | Voice ID | Name | Description |
  |----------|------|-------------|
  | `21m00Tcm4TlvDq8ikWAM` | Rachel | Calm, American female |
  | `pNInz6obpgDQGcFmaJgB` | Adam | Deep, American male |
  | `EXAVITQu4vr4xnSDxMaL` | Sarah | Soft, American female |
  | `TxGEqnHWrfWFTfGW9XjX` | Josh | Strong, American male |
  | `cjVigY5qzO86Huf0OWal` | Eric | Friendly, American male |

  **Default:** `11labs-Kate`
</ParamField>

<ParamField body="llm_model" type="string">
  LLM model for conversations. Use the [List Models](/api-reference/endpoints/list-models) endpoint to get all available options.

  | Model ID | Description |
  |----------|-------------|
  | `gpt-4.1-nano` | Fastest response time (default) |
  | `gpt-4o-mini` | Fast and cost-effective |
  | `gpt-4o` | Most capable, higher latency |

  **Default:** `gpt-4.1-nano`
</ParamField>

<ParamField body="language" type="string">
  Primary language for the agent.

  **Default:** `en-US`

  **Supported:** `en-US`, `en-GB`, `es-ES`, `fr-FR`, `de-DE`
</ParamField>

<ParamField body="agent_type" type="string">
  The type of agent.

  **Default:** `inbound`
</ParamField>

<ParamField body="organization_name" type="string">
  Name of the organization the agent represents.

  **Example:** `"Acme Corp"`
</ParamField>

<ParamField body="owner_name" type="string">
  Name of the agent's owner.

  **Example:** `"Jane Smith"`
</ParamField>

<ParamField body="agent_role" type="string">
  Description of the agent's role.

  **Example:** `"Front desk receptionist"`
</ParamField>

<ParamField body="transfer_phone_number" type="string">
  Phone number to transfer calls to when requested.

  **Example:** `"+14155551234"`
</ParamField>

<ParamField body="is_active" type="boolean">
  Whether the agent is active and can receive calls.

  **Default:** `true`
</ParamField>

<ParamField body="temperature" type="number">
  LLM temperature for response creativity.

  **Default:** `0.7`

  **Range:** 0 to 1
</ParamField>

<ParamField body="functions" type="object">
  Configuration for agent functions (capabilities) the agent can use during calls.

  ### end_call
  | Property | Type | Description |
  |----------|------|-------------|
  | `enabled` | boolean | Allow agent to hang up when conversation is complete. Default: `true` |
  | `description` | string | When to end calls. Default: "End the call when the conversation is complete or caller says goodbye." |

  ### transfer
  | Property | Type | Description |
  |----------|------|-------------|
  | `enabled` | boolean | Allow agent to transfer calls. Default: `false` |
  | `numbers` | array | Transfer destinations. Each: `{ number, label, description }` |
  | `description` | string | General instruction for transfer behavior |

  **Transfer number format:**
  ```json
  {
    "number": "+14155551234",
    "label": "Sales",
    "description": "Transfer for sales inquiries"
  }
  ```

  ### sms
  | Property | Type | Description |
  |----------|------|-------------|
  | `enabled` | boolean | Allow agent to send SMS messages. Default: `false` |
  | `description` | string | When to send SMS |
  | `templates` | array | Pre-defined message templates |

  ### extract_data
  | Property | Type | Description |
  |----------|------|-------------|
  | `enabled` | boolean | Extract structured data from conversations. Default: `false` |
  | `schema` | object | JSON schema defining fields to extract |
  | `description` | string | What data to collect |

  ### booking
  | Property | Type | Description |
  |----------|------|-------------|
  | `enabled` | boolean | Allow agent to book appointments. Default: `false` |
  | `calendar_id` | string | Connected calendar ID |
  | `description` | string | Booking behavior instruction |
  | `get_availability` | object | `{ enabled, description }` for availability checks |

  **Example:**
  ```json
  {
    "end_call": {
      "enabled": true,
      "description": "End the call when the customer confirms their order or says goodbye."
    },
    "transfer": {
      "enabled": true,
      "numbers": [
        { "number": "+14155551234", "label": "Sales", "description": "Transfer for sales inquiries" },
        { "number": "+14155555678", "label": "Support", "description": "Transfer for technical issues" }
      ],
      "description": "Transfer when caller requests to speak with a specific department."
    },
    "sms": {
      "enabled": true,
      "description": "Send order confirmation via SMS after completing an order."
    }
  }
  ```
</ParamField>

## Response

Returns the full agent object wrapped in an `agent` key.

<ResponseField name="agent" type="object">
  <Expandable title="Agent object">
    <ResponseField name="id" type="string">
      Unique identifier (UUID) for the agent config row.
    </ResponseField>

    <ResponseField name="agent_id" type="string">
      Unique agent identifier (UUID) used for dispatch and assignment.
    </ResponseField>

    <ResponseField name="name" type="string">
      Agent display name.
    </ResponseField>

    <ResponseField name="greeting" type="string">
      Call greeting message.
    </ResponseField>

    <ResponseField name="system_prompt" type="string">
      Agent instructions.
    </ResponseField>

    <ResponseField name="voice_id" type="string">
      Selected voice ID.
    </ResponseField>

    <ResponseField name="is_active" type="boolean">
      Active status.
    </ResponseField>

    <ResponseField name="created_at" type="string">
      ISO 8601 creation timestamp.
    </ResponseField>

    <ResponseField name="updated_at" type="string">
      ISO 8601 last update timestamp.
    </ResponseField>
  </Expandable>
</ResponseField>

## Example Request

<CodeGroup>

```bash cURL
curl -X POST "https://api.magpipe.ai/functions/v1/create-agent" \
  -H "Authorization: Bearer mgp_your_api_key" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Reception Agent",
    "greeting": "Hello, thanks for calling! How can I help you today?",
    "system_prompt": "You are a friendly receptionist. Be helpful and professional.",
    "voice_id": "21m00Tcm4TlvDq8ikWAM"
  }'
```

```javascript JavaScript
const response = await fetch('https://api.magpipe.ai/functions/v1/create-agent', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer mgp_your_api_key',
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    name: 'Reception Agent',
    greeting: 'Hello, thanks for calling! How can I help you today?',
    system_prompt: 'You are a friendly receptionist. Be helpful and professional.',
    voice_id: '21m00Tcm4TlvDq8ikWAM',
  }),
});

const data = await response.json();
console.log(data.agent);
```

```python Python
import requests

response = requests.post(
    'https://api.magpipe.ai/functions/v1/create-agent',
    headers={
        'Authorization': 'Bearer mgp_your_api_key',
        'Content-Type': 'application/json',
    },
    json={
        'name': 'Reception Agent',
        'greeting': 'Hello, thanks for calling! How can I help you today?',
        'system_prompt': 'You are a friendly receptionist. Be helpful and professional.',
        'voice_id': '21m00Tcm4TlvDq8ikWAM',
    },
)

print(response.json()['agent'])
```

</CodeGroup>

## Example Response

```json
{
  "agent": {
    "id": "c72ea2b8-1234-5678-9abc-def012345678",
    "agent_id": "a1b2c3d4-5678-9abc-def0-123456789abc",
    "name": "Reception Agent",
    "greeting": "Hello, thanks for calling! How can I help you today?",
    "system_prompt": "You are a friendly receptionist. Be helpful and professional.",
    "voice_id": "21m00Tcm4TlvDq8ikWAM",
    "llm_model": "gpt-4.1-nano",
    "language": "en-US",
    "is_active": true,
    "created_at": "2024-01-15T10:00:00.000Z",
    "updated_at": "2024-01-15T10:00:00.000Z"
  }
}
```

## Error Responses

<ResponseExample>
```json 400 Bad Request
{
  "error": {
    "code": "missing_param",
    "message": "name is required"
  }
}
```
</ResponseExample>

<ResponseExample>
```json 401 Unauthorized
{
  "error": {
    "code": "unauthorized",
    "message": "Unauthorized"
  }
}
```
</ResponseExample>

## Related Endpoints

- [List Agents](/api-reference/endpoints/list-agents) - Get all agents
- [Get Agent](/api-reference/endpoints/get-agent) - Get agent details
- [Update Agent](/api-reference/endpoints/update-agent) - Modify an agent
- [Delete Agent](/api-reference/endpoints/delete-agent) - Remove an agent
